package util

import (
	"fmt"
	"regexp"
)

var mapEscapedChar map[string]string

func init() {
	mapEscapedChar = make(map[string]string)
	mapEscapedChar["&#8482;"] = "™"
	mapEscapedChar["&#32;"] = " "
	mapEscapedChar["&#33;"] = "!"
	mapEscapedChar["&#34;"] = "\""
	mapEscapedChar["&#35;"] = "#"
	mapEscapedChar["&#36;"] = "$"
	mapEscapedChar["&#37;"] = "%"
	mapEscapedChar["&#38;"] = "&"
	mapEscapedChar["&#39;"] = "'"
	mapEscapedChar["&#40;"] = "("
	mapEscapedChar["&#41;"] = ")"
	mapEscapedChar["&#42;"] = "*"
	mapEscapedChar["&#43;"] = "+"
	mapEscapedChar["&#44;"] = ","
	mapEscapedChar["&#45;"] = "-"
	mapEscapedChar["&#46;"] = "."
	mapEscapedChar["&#47;"] = "/"
	mapEscapedChar["&#48;"] = "0"
	mapEscapedChar["&#49;"] = "1"
	mapEscapedChar["&#50;"] = "2"
	mapEscapedChar["&#51;"] = "3"
	mapEscapedChar["&#52;"] = "4"
	mapEscapedChar["&#53;"] = "5"
	mapEscapedChar["&#54;"] = "6"
	mapEscapedChar["&#55;"] = "7"
	mapEscapedChar["&#56;"] = "8"
	mapEscapedChar["&#57;"] = "9"
	mapEscapedChar["&#58;"] = ":"
	mapEscapedChar["&#59;"] = ";"
	mapEscapedChar["&#60;"] = "<"
	mapEscapedChar["&#61;"] = "="
	mapEscapedChar["&#62;"] = ">"
	mapEscapedChar["&#63;"] = "?"
	mapEscapedChar["&#64;"] = "@"
	mapEscapedChar["&#65;"] = "A"
	mapEscapedChar["&#66;"] = "B"
	mapEscapedChar["&#67;"] = "C"
	mapEscapedChar["&#68;"] = "D"
	mapEscapedChar["&#69;"] = "E"
	mapEscapedChar["&#70;"] = "F"
	mapEscapedChar["&#71;"] = "G"
	mapEscapedChar["&#72;"] = "H"
	mapEscapedChar["&#73;"] = "I"
	mapEscapedChar["&#74;"] = "J"
	mapEscapedChar["&#75;"] = "K"
	mapEscapedChar["&#76;"] = "L"
	mapEscapedChar["&#77;"] = "M"
	mapEscapedChar["&#78;"] = "N"
	mapEscapedChar["&#79;"] = "O"
	mapEscapedChar["&#80;"] = "P"
	mapEscapedChar["&#81;"] = "Q"
	mapEscapedChar["&#82;"] = "R"
	mapEscapedChar["&#83;"] = "S"
	mapEscapedChar["&#84;"] = "T"
	mapEscapedChar["&#85;"] = "U"
	mapEscapedChar["&#86;"] = "V"
	mapEscapedChar["&#87;"] = "W"
	mapEscapedChar["&#88;"] = "X"
	mapEscapedChar["&#89;"] = "Y"
	mapEscapedChar["&#90;"] = "Z"
	mapEscapedChar["&#91;"] = "["
	mapEscapedChar["&#92;"] = "\\"
	mapEscapedChar["&#93;"] = "]"
	mapEscapedChar["&#94;"] = "^"
	mapEscapedChar["&#95;"] = "_"
	mapEscapedChar["&#96;"] = "`"
	mapEscapedChar["&#97;"] = "a"
	mapEscapedChar["&#98;"] = "b"
	mapEscapedChar["&#99;"] = "c"
	mapEscapedChar["&#100;"] = "d"
	mapEscapedChar["&#101;"] = "e"
	mapEscapedChar["&#102;"] = "f"
	mapEscapedChar["&#103;"] = "g"
	mapEscapedChar["&#104;"] = "h"
	mapEscapedChar["&#105;"] = "i"
	mapEscapedChar["&#106;"] = "j"
	mapEscapedChar["&#107;"] = "k"
	mapEscapedChar["&#108;"] = "l"
	mapEscapedChar["&#109;"] = "m"
	mapEscapedChar["&#110;"] = "n"
	mapEscapedChar["&#111;"] = "o"
	mapEscapedChar["&#112;"] = "p"
	mapEscapedChar["&#113;"] = "q"
	mapEscapedChar["&#114;"] = "r"
	mapEscapedChar["&#115;"] = "s"
	mapEscapedChar["&#116;"] = "t"
	mapEscapedChar["&#117;"] = "u"
	mapEscapedChar["&#118;"] = "v"
	mapEscapedChar["&#119;"] = "w"
	mapEscapedChar["&#120;"] = "x"
	mapEscapedChar["&#121;"] = "y"
	mapEscapedChar["&#122;"] = "z"
	mapEscapedChar["&#123;"] = "{"
	mapEscapedChar["&#124;"] = "|"
	mapEscapedChar["&#125;"] = "}"
	mapEscapedChar["&#126;"] = "~"
	mapEscapedChar["&#160;"] = " "
	mapEscapedChar["&#161;"] = "¡"
	mapEscapedChar["&#162;"] = "¢"
	mapEscapedChar["&#163;"] = "£"
	mapEscapedChar["&#164;"] = "¤"
	mapEscapedChar["&#165;"] = "¥"
	mapEscapedChar["&#166;"] = "¦"
	mapEscapedChar["&#167;"] = "§"
	mapEscapedChar["&#168;"] = "¨"
	mapEscapedChar["&#169;"] = "©"
	mapEscapedChar["&#170;"] = "ª"
	mapEscapedChar["&#171;"] = "«"
	mapEscapedChar["&#172;"] = "¬"
	mapEscapedChar["&#173;"] = "­"
	mapEscapedChar["&#174;"] = "®"
	mapEscapedChar["&#175;"] = "¯"
	mapEscapedChar["&#176;"] = "°"
	mapEscapedChar["&#177;"] = "±"
	mapEscapedChar["&#178;"] = "²"
	mapEscapedChar["&#179;"] = "³"
	mapEscapedChar["&#180;"] = "´"
	mapEscapedChar["&#181;"] = "µ"
	mapEscapedChar["&#182;"] = "¶"
	mapEscapedChar["&#183;"] = "·"
	mapEscapedChar["&#184;"] = "¸"
	mapEscapedChar["&#185;"] = "¹"
	mapEscapedChar["&#186;"] = "º"
	mapEscapedChar["&#187;"] = "»"
	mapEscapedChar["&#188;"] = "¼"
	mapEscapedChar["&#189;"] = "½"
	mapEscapedChar["&#190;"] = "¾"
	mapEscapedChar["&#191;"] = "¿"
	mapEscapedChar["&#192;"] = "À"
	mapEscapedChar["&#193;"] = "Á"
	mapEscapedChar["&#194;"] = "Â"
	mapEscapedChar["&#195;"] = "Ã"
	mapEscapedChar["&#196;"] = "Ä"
	mapEscapedChar["&#197;"] = "Å"
	mapEscapedChar["&#198;"] = "Æ"
	mapEscapedChar["&#199;"] = "Ç"
	mapEscapedChar["&#200;"] = "È"
	mapEscapedChar["&#201;"] = "É"
	mapEscapedChar["&#202;"] = "Ê"
	mapEscapedChar["&#203;"] = "Ë"
	mapEscapedChar["&#204;"] = "Ì"
	mapEscapedChar["&#205;"] = "Í"
	mapEscapedChar["&#206;"] = "Î"
	mapEscapedChar["&#207;"] = "Ï"
	mapEscapedChar["&#208;"] = "Ð"
	mapEscapedChar["&#209;"] = "Ñ"
	mapEscapedChar["&#210;"] = "Ò"
	mapEscapedChar["&#211;"] = "Ó"
	mapEscapedChar["&#212;"] = "Ô"
	mapEscapedChar["&#213;"] = "Õ"
	mapEscapedChar["&#214;"] = "Ö"
	mapEscapedChar["&#215;"] = "×"
	mapEscapedChar["&#216;"] = "Ø"
	mapEscapedChar["&#217;"] = "Ù"
	mapEscapedChar["&#218;"] = "Ú"
	mapEscapedChar["&#219;"] = "Û"
	mapEscapedChar["&#220;"] = "Ü"
	mapEscapedChar["&#221;"] = "Ý"
	mapEscapedChar["&#222;"] = "Þ"
	mapEscapedChar["&#223;"] = "ß"
	mapEscapedChar["&#224;"] = "à"
	mapEscapedChar["&#225;"] = "á"
	mapEscapedChar["&#226;"] = "â"
	mapEscapedChar["&#227;"] = "ã"
	mapEscapedChar["&#228;"] = "ä"
	mapEscapedChar["&#229;"] = "å"
	mapEscapedChar["&#230;"] = "æ"
	mapEscapedChar["&#231;"] = "ç"
	mapEscapedChar["&#232;"] = "è"
	mapEscapedChar["&#233;"] = "é"
	mapEscapedChar["&#234;"] = "ê"
	mapEscapedChar["&#235;"] = "ë"
	mapEscapedChar["&#236;"] = "ì"
	mapEscapedChar["&#237;"] = "í"
	mapEscapedChar["&#238;"] = "î"
	mapEscapedChar["&#239;"] = "ï"
	mapEscapedChar["&#240;"] = "ð"
	mapEscapedChar["&#241;"] = "ñ"
	mapEscapedChar["&#242;"] = "ò"
	mapEscapedChar["&#243;"] = "ó"
	mapEscapedChar["&#244;"] = "ô"
	mapEscapedChar["&#245;"] = "õ"
	mapEscapedChar["&#246;"] = "ö"
	mapEscapedChar["&#247;"] = "÷"
	mapEscapedChar["&#248;"] = "ø"
	mapEscapedChar["&#249;"] = "ù"
	mapEscapedChar["&#250;"] = "ú"
	mapEscapedChar["&#251;"] = "û"
	mapEscapedChar["&#252;"] = "ü"
	mapEscapedChar["&#253;"] = "ý"
	mapEscapedChar["&#254;"] = "þ"
	mapEscapedChar["&#255;"] = "ÿ"
	mapEscapedChar["&#256;"] = "Ā"
	mapEscapedChar["&#257;"] = "ā"
	mapEscapedChar["&#258;"] = "Ă"
	mapEscapedChar["&#259;"] = "ă"
	mapEscapedChar["&#260;"] = "Ą"
	mapEscapedChar["&#261;"] = "ą"
	mapEscapedChar["&#262;"] = "Ć"
	mapEscapedChar["&#263;"] = "ć"
	mapEscapedChar["&#264;"] = "Ĉ"
	mapEscapedChar["&#265;"] = "ĉ"
	mapEscapedChar["&#266;"] = "Ċ"
	mapEscapedChar["&#267;"] = "ċ"
	mapEscapedChar["&#268;"] = "Č"
	mapEscapedChar["&#269;"] = "č"
	mapEscapedChar["&#270;"] = "Ď"
	mapEscapedChar["&#271;"] = "ď"
	mapEscapedChar["&#272;"] = "Đ"
	mapEscapedChar["&#273;"] = "đ"
	mapEscapedChar["&#274;"] = "Ē"
	mapEscapedChar["&#275;"] = "ē"
	mapEscapedChar["&#276;"] = "Ĕ"
	mapEscapedChar["&#277;"] = "ĕ"
	mapEscapedChar["&#278;"] = "Ė"
	mapEscapedChar["&#279;"] = "ė"
	mapEscapedChar["&#280;"] = "Ę"
	mapEscapedChar["&#281;"] = "ę"
	mapEscapedChar["&#282;"] = "Ě"
	mapEscapedChar["&#283;"] = "ě"
	mapEscapedChar["&#284;"] = "Ĝ"
	mapEscapedChar["&#285;"] = "ĝ"
	mapEscapedChar["&#286;"] = "Ğ"
	mapEscapedChar["&#287;"] = "ğ"
	mapEscapedChar["&#288;"] = "Ġ"
	mapEscapedChar["&#289;"] = "ġ"
	mapEscapedChar["&#290;"] = "Ģ"
	mapEscapedChar["&#291;"] = "ģ"
	mapEscapedChar["&#292;"] = "Ĥ"
	mapEscapedChar["&#293;"] = "ĥ"
	mapEscapedChar["&#294;"] = "Ħ"
	mapEscapedChar["&#295;"] = "ħ"
	mapEscapedChar["&#296;"] = "Ĩ"
	mapEscapedChar["&#297;"] = "ĩ"
	mapEscapedChar["&#298;"] = "Ī"
	mapEscapedChar["&#299;"] = "ī"
	mapEscapedChar["&#300;"] = "Ĭ"
	mapEscapedChar["&#301;"] = "ĭ"
	mapEscapedChar["&#302;"] = "Į"
	mapEscapedChar["&#303;"] = "į"
	mapEscapedChar["&#304;"] = "İ"
	mapEscapedChar["&#305;"] = "ı"
	mapEscapedChar["&#306;"] = "Ĳ"
	mapEscapedChar["&#307;"] = "ĳ"
	mapEscapedChar["&#308;"] = "Ĵ"
	mapEscapedChar["&#309;"] = "ĵ"
	mapEscapedChar["&#310;"] = "Ķ"
	mapEscapedChar["&#311;"] = "ķ"
	mapEscapedChar["&#312;"] = "ĸ"
	mapEscapedChar["&#313;"] = "Ĺ"
	mapEscapedChar["&#314;"] = "ĺ"
	mapEscapedChar["&#315;"] = "Ļ"
	mapEscapedChar["&#316;"] = "ļ"
	mapEscapedChar["&#317;"] = "Ľ"
	mapEscapedChar["&#318;"] = "ľ"
	mapEscapedChar["&#319;"] = "Ŀ"
	mapEscapedChar["&#320;"] = "ŀ"
	mapEscapedChar["&#321;"] = "Ł"
	mapEscapedChar["&#322;"] = "ł"
	mapEscapedChar["&#323;"] = "Ń"
	mapEscapedChar["&#324;"] = "ń"
	mapEscapedChar["&#325;"] = "Ņ"
	mapEscapedChar["&#326;"] = "ņ"
	mapEscapedChar["&#327;"] = "Ň"
	mapEscapedChar["&#328;"] = "ň"
	mapEscapedChar["&#329;"] = "ŉ"
	mapEscapedChar["&#330;"] = "Ŋ"
	mapEscapedChar["&#331;"] = "ŋ"
	mapEscapedChar["&#332;"] = "Ō"
	mapEscapedChar["&#333;"] = "ō"
	mapEscapedChar["&#334;"] = "Ŏ"
	mapEscapedChar["&#335;"] = "ŏ"
	mapEscapedChar["&#336;"] = "Ő"
	mapEscapedChar["&#337;"] = "ő"
	mapEscapedChar["&#338;"] = "Œ"
	mapEscapedChar["&#339;"] = "œ"
	mapEscapedChar["&#340;"] = "Ŕ"
	mapEscapedChar["&#341;"] = "ŕ"
	mapEscapedChar["&#342;"] = "Ŗ"
	mapEscapedChar["&#343;"] = "ŗ"
	mapEscapedChar["&#344;"] = "Ř"
	mapEscapedChar["&#345;"] = "ř"
	mapEscapedChar["&#346;"] = "Ś"
	mapEscapedChar["&#347;"] = "ś"
	mapEscapedChar["&#348;"] = "Ŝ"
	mapEscapedChar["&#349;"] = "ŝ"
	mapEscapedChar["&#350;"] = "Ş"
	mapEscapedChar["&#351;"] = "ş"
	mapEscapedChar["&#352;"] = "Š"
	mapEscapedChar["&#353;"] = "š"
	mapEscapedChar["&#354;"] = "Ţ"
	mapEscapedChar["&#355;"] = "ţ"
	mapEscapedChar["&#356;"] = "Ť"
	mapEscapedChar["&#357;"] = "ť"
	mapEscapedChar["&#358;"] = "Ŧ"
	mapEscapedChar["&#359;"] = "ŧ"
	mapEscapedChar["&#360;"] = "Ũ"
	mapEscapedChar["&#361;"] = "ũ"
	mapEscapedChar["&#362;"] = "Ū"
	mapEscapedChar["&#363;"] = "ū"
	mapEscapedChar["&#364;"] = "Ŭ"
	mapEscapedChar["&#365;"] = "ŭ"
	mapEscapedChar["&#366;"] = "Ů"
	mapEscapedChar["&#367;"] = "ů"
	mapEscapedChar["&#368;"] = "Ű"
	mapEscapedChar["&#369;"] = "ű"
	mapEscapedChar["&#370;"] = "Ų"
	mapEscapedChar["&#371;"] = "ų"
	mapEscapedChar["&#372;"] = "Ŵ"
	mapEscapedChar["&#373;"] = "ŵ"
	mapEscapedChar["&#374;"] = "Ŷ"
	mapEscapedChar["&#375;"] = "ŷ"
	mapEscapedChar["&#376;"] = "Ÿ"
	mapEscapedChar["&#377;"] = "Ź"
	mapEscapedChar["&#378;"] = "ź"
	mapEscapedChar["&#379;"] = "Ż"
	mapEscapedChar["&#380;"] = "ż"
	mapEscapedChar["&#381;"] = "Ž"
	mapEscapedChar["&#382;"] = "ž"
	mapEscapedChar["&#383;"] = "ſ"
	mapEscapedChar["&#340;"] = "Ŕ"
	mapEscapedChar["&#341;"] = "ŕ"
	mapEscapedChar["&#342;"] = "Ŗ"
	mapEscapedChar["&#343;"] = "ŗ"
	mapEscapedChar["&#344;"] = "Ř"
	mapEscapedChar["&#345;"] = "ř"
	mapEscapedChar["&#346;"] = "Ś"
	mapEscapedChar["&#347;"] = "ś"
	mapEscapedChar["&#348;"] = "Ŝ"
	mapEscapedChar["&#349;"] = "ŝ"
	mapEscapedChar["&#350;"] = "Ş"
	mapEscapedChar["&#351;"] = "ş"
	mapEscapedChar["&#352;"] = "Š"
	mapEscapedChar["&#353;"] = "š"
	mapEscapedChar["&#354;"] = "Ţ"
	mapEscapedChar["&#355;"] = "ţ"
	mapEscapedChar["&#356;"] = "Ť"
	mapEscapedChar["&#577;"] = "ť"
	mapEscapedChar["&#358;"] = "Ŧ"
	mapEscapedChar["&#359;"] = "ŧ"
	mapEscapedChar["&#360;"] = "Ũ"
	mapEscapedChar["&#361;"] = "ũ"
	mapEscapedChar["&#362;"] = "Ū"
	mapEscapedChar["&#363;"] = "ū"
	mapEscapedChar["&#364;"] = "Ŭ"
	mapEscapedChar["&#365;"] = "ŭ"
	mapEscapedChar["&#366;"] = "Ů"
	mapEscapedChar["&#367;"] = "ů"
	mapEscapedChar["&#368;"] = "Ű"
	mapEscapedChar["&#369;"] = "ű"
	mapEscapedChar["&#370;"] = "Ų"
	mapEscapedChar["&#371;"] = "ų"
	mapEscapedChar["&#372;"] = "Ŵ"
	mapEscapedChar["&#373;"] = "ŵ"
	mapEscapedChar["&#374;"] = "Ŷ"
	mapEscapedChar["&#375;"] = "ŷ"
	mapEscapedChar["&#376;"] = "Ÿ"
	mapEscapedChar["&#377;"] = "Ź"
	mapEscapedChar["&#378;"] = "ź"
	mapEscapedChar["&#379;"] = "Ż"
	mapEscapedChar["&#380;"] = "ż"
	mapEscapedChar["&#381;"] = "Ž"
	mapEscapedChar["&#382;"] = "ž"
	mapEscapedChar["&#383;"] = "ſ"
}

var replaced = false

func replaceFunc (b string) string {
	fmt.Println("Matched:", b)
	if val, ok := mapEscapedChar[b]; ok {
		replaced = true
		return val
	}
	return b
}

func UnEscape(in string) (bool, string) {
	reg := regexp.MustCompile("&#[0-9]{1,4};")
	replaced = false
	s := reg.ReplaceAllStringFunc(in, replaceFunc)
	fmt.Println("Result:", s)

	return replaced, s
}